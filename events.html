<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Events - Code For All</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <style>
        /* Events Page Specific Styles */
        .events-container {
            display: flex;
            flex-direction: column;
            gap: 30px;
        }
        
        .event-card {
            background-color: white;
            border-radius: 10px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        
        .event-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .event-header {
            display: flex;
            align-items: center;
        }
        
        .event-date {
            background-color: #3498db;
            color: white;
            padding: 20px;
            text-align: center;
            min-width: 100px;
        }
        
        .event-date .day {
            font-size: 2rem;
            font-weight: 700;
            line-height: 1;
        }
        
        .event-date .month {
            font-size: 1rem;
            text-transform: uppercase;
        }
        
        .event-title {
            padding: 20px;
        }
        
        .event-title h3 {
            font-size: 1.5rem;
            margin-bottom: 5px;
            color: #2c3e50;
        }
        
        .event-title .event-meta {
            display: flex;
            gap: 15px;
            color: #7f8c8d;
            font-size: 0.9rem;
        }
        
        .event-title .event-meta i {
            margin-right: 5px;
            color: #3498db;
        }
        
        .event-content {
            padding: 0 20px 20px;
        }
        
        .event-image {
            width: 100%;
            height: 250px;
            object-fit: cover;
        }
        
        .event-actions {
            display: flex;
            justify-content: space-between;
            padding: 20px;
            background-color: #f8f9fa;
            border-top: 1px solid #ecf0f1;
        }
        
        .event-actions .btn {
            padding: 8px 16px;
        }
        
        .event-actions .share-links {
            display: flex;
            gap: 10px;
        }
        
        .event-actions .share-links a {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 36px;
            height: 36px;
            background-color: #ecf0f1;
            border-radius: 50%;
            color: #7f8c8d;
            transition: all 0.3s ease;
        }
        
        .event-actions .share-links a:hover {
            background-color: #3498db;
            color: white;
        }
        
        .event-tabs {
            display: flex;
            margin-bottom: 30px;
            border-bottom: 2px solid #ecf0f1;
        }
        
        .event-tab {
            padding: 15px 30px;
            font-weight: 600;
            color: #7f8c8d;
            cursor: pointer;
            position: relative;
            transition: color 0.3s ease;
        }
        
        .event-tab.active {
            color: #3498db;
        }
        
        .event-tab.active::after {
            content: '';
            position: absolute;
            bottom: -2px;
            left: 0;
            width: 100%;
            height: 2px;
            background-color: #3498db;
        }
        
        .event-tab:hover {
            color: #3498db;
        }
        
        .past-events {
            display: none;
        }
        
        .past-events.active {
            display: block;
        }
        
        .upcoming-events {
            display: none;
        }
        
        .upcoming-events.active {
            display: block;
        }
        
        .calendar-view {
            margin-top: 50px;
        }
        
        .calendar-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .calendar-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #2c3e50;
        }
        
        .calendar-nav {
            display: flex;
            gap: 10px;
        }
        
        .calendar-nav button {
            background-color: #ecf0f1;
            border: none;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        
        .calendar-nav button:hover {
            background-color: #3498db;
            color: white;
        }
        
        /* Admin Panel Styles */
        .admin-panel {
            background: #f8f9fa;
            border: 2px solid #3498db;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            text-align: center;
        }
        
        .admin-panel h3 {
            color: #2c3e50;
            margin-bottom: 15px;
        }
        
        .admin-controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }
        
        .btn-secondary {
            background: #6c757d;
            color: white;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        /* Modal Styles */
        .event-modal {
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }
        
        .modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 20px;
            border-radius: 10px;
            width: 90%;
            max-width: 500px;
            position: relative;
        }
        
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
            position: absolute;
            right: 15px;
            top: 10px;
        }
        
        .close:hover {
            color: #000;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
            color: #2c3e50;
        }
        
        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .form-group textarea {
            resize: vertical;
        }
        
        .form-actions {
            display: flex;
            gap: 10px;
            justify-content: flex-end;
            margin-top: 20px;
        }
        
        /* Calendar day with event indicator */
        .calendar-day.has-event {
            background: linear-gradient(135deg, #3498db, #2980b9);
            color: white;
        }
        
        .calendar-day.has-event:hover {
            background: linear-gradient(135deg, #2980b9, #1f5f8b);
        }
        
        .event-indicator {
            width: 6px;
            height: 6px;
            background: #e74c3c;
            border-radius: 50%;
            margin: 2px auto;
        }
        
        .error-message {
            color: #e74c3c;
            font-size: 14px;
            margin: 10px 0;
            padding: 8px;
            background-color: #fdf2f2;
            border: 1px solid #f5c6cb;
            border-radius: 4px;
        }
        
        .admin-status {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            padding: 10px;
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 4px;
            color: #155724;
        }
        
        .logout-btn {
            background-color: #dc3545;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .logout-btn:hover {
            background-color: #c82333;
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 10px;
        }
        
        .calendar-day-header {
            text-align: center;
            font-weight: 600;
            color: #7f8c8d;
            padding: 10px;
        }
        
        .calendar-day {
            height: 80px;
            background-color: white;
            border-radius: 5px;
            padding: 5px;
            position: relative;
        }
        
        .calendar-day.has-event {
            background-color: #f1f8fe;
        }
        
        .calendar-day.has-event::after {
            content: '';
            position: absolute;
            top: 5px;
            right: 5px;
            width: 8px;
            height: 8px;
            background-color: #3498db;
            border-radius: 50%;
        }
        
        .calendar-day-number {
            font-size: 0.9rem;
            color: #7f8c8d;
        }
        
        .calendar-day.today {
            border: 2px solid #3498db;
        }
        
        .calendar-day.today .calendar-day-number {
            color: #3498db;
            font-weight: 600;
        }
        
        .calendar-day.other-month {
            opacity: 0.3;
        }
        
        @media (max-width: 768px) {
            .event-header {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .event-date {
                width: 100%;
                display: flex;
                justify-content: center;
                gap: 10px;
                align-items: center;
            }
            
            .calendar-grid {
                grid-template-columns: repeat(7, 1fr);
                gap: 5px;
            }
            
            .calendar-day {
                height: 60px;
            }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="logo">
          <a href="index.html">
            <img src="logo_big_light.png" alt="Code for All Logo" class="logo-img">
          </a>
        </div>
            <nav>
                <ul>
                    <li><a href="index.html">Home</a></li>
                    <li><a href="events.html" class="active">Events</a></li>
                    <li><a href="contact.html">Contact</a></li>
                    <li><a href="team.html">Team</a></li>
                    <li><a href="login.html">Login</a></li>
                </ul>
            </nav>
            <div class="menu-toggle">
                ☰
            </div>
        </div>
    </header>

    <section class="page-header" style="background: linear-gradient(rgba(52, 152, 219, 0.8), rgba(41, 128, 185, 0.9)), url('coding_classroom.jpg') no-repeat center center/cover; height: 300px; display: flex; align-items: center; justify-content: center; margin-top: 80px;">
        <div class="container">
            <h1 style="color: white; font-size: 3rem; text-align: center;">Upcoming Events</h1>
            <p style="color: white; text-align: center; max-width: 700px; margin: 0 auto;">Join us for these exciting opportunities to learn coding and make a difference through technology.</p>
        </div>
    </section>

    <section class="events-section">
        <div class="container">
            <div class="event-tabs">
                <div class="event-tab upcoming-tab active">Upcoming Events</div>
                <div class="event-tab past-tab">Past Events</div>
            </div>
            
            <div class="upcoming-events active">
                <div class="events-container">
                    <!-- Event 1 -->
                    <div class="event-card">
                        <div class="event-header">
                            <div class="event-date">
                                <div class="day">15</div>
                                <div class="month">Nov</div>
                            </div>
                            <div class="event-title">
                                <h3>Food Drive Collection Day</h3>
                                <div class="event-meta">
                                    <span><i class="fas fa-clock"></i> 3:00 PM - 6:00 PM</span>
                                    <span><i class="fas fa-map-marker-alt"></i> School Cafeteria</span>
                                </div>
                            </div>
                        </div>
                        <img src="coding_event.jpg" alt="Coding Event" class="event-image">
                        <div class="event-content">
                            <p>Join us for our monthly food drive collection day. We'll be collecting non-perishable food items to donate to the local food bank. Bring your donations to the school cafeteria after classes.</p>
                            <p>Most needed items: canned vegetables, pasta, rice, peanut butter, and canned tuna.</p>
                        </div>
                        <div class="event-actions">
                            <a href="#" class="btn">RSVP Now</a>
                            <div class="share-links">
                                <a href="#"><i class="fab fa-facebook-f"></i></a>
                                <a href="#"><i class="fab fa-twitter"></i></a>
                                <a href="#"><i class="fas fa-envelope"></i></a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Event 2 -->
                    <div class="event-card">
                        <div class="event-header">
                            <div class="event-date">
                                <div class="day">28</div>
                                <div class="month">Nov</div>
                            </div>
                            <div class="event-title">
                                <h3>Charity Bake Sale</h3>
                                <div class="event-meta">
                                    <span><i class="fas fa-clock"></i> 11:00 AM - 1:00 PM</span>
                                    <span><i class="fas fa-map-marker-alt"></i> School Courtyard</span>
                                </div>
                            </div>
                        </div>
                        <img src="coding_students.jpg" alt="Coding Students" class="event-image">
                        <div class="event-content">
                            <p>Our annual charity bake sale is back! All proceeds will go to supporting our local food bank initiative. Come enjoy delicious homemade treats while supporting a great cause.</p>
                            <p>Want to contribute baked goods? Contact us by November 25th to sign up as a baker!</p>
                        </div>
                        <div class="event-actions">
                            <a href="#" class="btn">Volunteer</a>
                            <div class="share-links">
                                <a href="#"><i class="fab fa-facebook-f"></i></a>
                                <a href="#"><i class="fab fa-twitter"></i></a>
                                <a href="#"><i class="fas fa-envelope"></i></a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Event 3 -->
                    <div class="event-card">
                        <div class="event-header">
                            <div class="event-date">
                                <div class="day">10</div>
                                <div class="month">Dec</div>
                            </div>
                            <div class="event-title">
                                <h3>Holiday Charity Concert</h3>
                                <div class="event-meta">
                                    <span><i class="fas fa-clock"></i> 7:00 PM - 9:00 PM</span>
                                    <span><i class="fas fa-map-marker-alt"></i> School Auditorium</span>
                                </div>
                            </div>
                        </div>
                        <img src="coding_project.jpg" alt="Coding Project" class="event-image">
                        <div class="event-content">
                            <p>Join us for a magical evening of music and giving! Our annual Holiday Charity Concert features performances from the school choir, band, and special guest performers.</p>
                            <p>Tickets are $5 for students and $10 for adults. All proceeds will benefit local families in need during the holiday season.</p>
                        </div>
                        <div class="event-actions">
                            <a href="#" class="btn">Get Tickets</a>
                            <div class="share-links">
                                <a href="#"><i class="fab fa-facebook-f"></i></a>
                                <a href="#"><i class="fab fa-twitter"></i></a>
                                <a href="#"><i class="fas fa-envelope"></i></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="past-events">
                <div class="events-container">
                    <!-- Past Event 1 -->
                    <div class="event-card">
                        <div class="event-header">
                            <div class="event-date">
                                <div class="day">20</div>
                                <div class="month">Oct</div>
                            </div>
                            <div class="event-title">
                                <h3>Community Clean-Up Day</h3>
                                <div class="event-meta">
                                    <span><i class="fas fa-clock"></i> 9:00 AM - 12:00 PM</span>
                                    <span><i class="fas fa-map-marker-alt"></i> City Park</span>
                                </div>
                            </div>
                        </div>
                        <img src="coding_workshop.jpg" alt="Coding Workshop" class="event-image">
                        <div class="event-content">
                            <p>We had an amazing turnout for our Community Clean-Up Day! Over 50 volunteers helped collect trash and recyclables from our local park.</p>
                            <p>Together, we collected over 30 bags of trash and 15 bags of recyclables. Thank you to everyone who participated!</p>
                        </div>
                        <div class="event-actions">
                            <a href="#" class="btn">View Photos</a>
                            <div class="share-links">
                                <a href="#"><i class="fab fa-facebook-f"></i></a>
                                <a href="#"><i class="fab fa-twitter"></i></a>
                                <a href="#"><i class="fas fa-envelope"></i></a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Past Event 2 -->
                    <div class="event-card">
                        <div class="event-header">
                            <div class="event-date">
                                <div class="day">5</div>
                                <div class="month">Oct</div>
                            </div>
                            <div class="event-title">
                                <h3>Fundraising Workshop</h3>
                                <div class="event-meta">
                                    <span><i class="fas fa-clock"></i> 4:00 PM - 5:30 PM</span>
                                    <span><i class="fas fa-map-marker-alt"></i> Room 203</span>
                                </div>
                            </div>
                        </div>
                        <img src="coding_classroom.jpg" alt="Coding Classroom" class="event-image">
                        <div class="event-content">
                            <p>Our Fundraising Workshop was a great success! We learned valuable strategies for planning and executing effective fundraising campaigns from Ms. Johnson, a professional fundraiser.</p>
                            <p>Participants received handouts with tips and resources that will help us with our upcoming initiatives.</p>
                        </div>
                        <div class="event-actions">
                            <a href="#" class="btn">Download Materials</a>
                            <div class="share-links">
                                <a href="#"><i class="fab fa-facebook-f"></i></a>
                                <a href="#"><i class="fab fa-twitter"></i></a>
                                <a href="#"><i class="fas fa-envelope"></i></a>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Past Event 3 -->
                    <div class="event-card">
                        <div class="event-header">
                            <div class="event-date">
                                <div class="day">15</div>
                                <div class="month">Sep</div>
                            </div>
                            <div class="event-title">
                                <h3>Back-to-School Supply Drive</h3>
                                <div class="event-meta">
                                    <span><i class="fas fa-clock"></i> All Day</span>
                                    <span><i class="fas fa-map-marker-alt"></i> School Entrance</span>
                                </div>
                            </div>
                        </div>
                        <img src="coding_event.jpg" alt="Coding Event" class="event-image">
                        <div class="event-content">
                            <p>Our Back-to-School Supply Drive was incredibly successful! Thanks to the generosity of our school community, we collected hundreds of notebooks, pencils, backpacks, and other essential supplies.</p>
                            <p>All items were donated to underprivileged students in our district to ensure everyone started the school year prepared.</p>
                        </div>
                        <div class="event-actions">
                            <a href="#" class="btn">Impact Report</a>
                            <div class="share-links">
                                <a href="#"><i class="fab fa-facebook-f"></i></a>
                                <a href="#"><i class="fab fa-twitter"></i></a>
                                <a href="#"><i class="fas fa-envelope"></i></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="calendar-view">
                <div class="calendar-header">
                    <div class="calendar-title" id="calendar-title">November 2024</div>
                    <div class="calendar-nav">
                        <button id="prev-month"><i class="fas fa-chevron-left"></i></button>
                        <button id="next-month"><i class="fas fa-chevron-right"></i></button>
                    </div>
                </div>
                
                <div class="calendar-grid" id="calendar-grid">
                    <!-- Day headers -->
                    <div class="calendar-day-header">Sun</div>
                    <div class="calendar-day-header">Mon</div>
                    <div class="calendar-day-header">Tue</div>
                    <div class="calendar-day-header">Wed</div>
                    <div class="calendar-day-header">Thu</div>
                    <div class="calendar-day-header">Fri</div>
                    <div class="calendar-day-header">Sat</div>
                    <!-- Calendar days will be generated dynamically -->
                </div>
                
                <!-- Admin Panel -->
                <div class="admin-panel" id="admin-panel" style="display: none;">
                    <div class="admin-status" id="admin-status">
                        <span>Admin Mode Active</span>
                        <span id="admin-user-display"></span>
                        <button id="logout-btn" class="logout-btn">Logout</button>
                    </div>
                    <h3>Admin: Event Management</h3>
                    <div class="admin-controls">
                        <button id="add-event" class="btn">Add New Event</button>
                        <button id="hide-admin-panel" class="btn btn-secondary">Hide Admin Panel</button>
                    </div>
                </div>
                
                <!-- Event Modal -->
                <div class="event-modal" id="event-modal" style="display: none;">
                    <div class="modal-content">
                        <span class="close" id="close-modal">&times;</span>
                        <h3 id="modal-title">Add New Event</h3>
                        <form id="event-form">
                            <div class="form-group">
                                <label for="event-title">Event Title:</label>
                                <input type="text" id="event-title" required>
                            </div>
                            <div class="form-group">
                                <label for="event-date">Date:</label>
                                <input type="date" id="event-date" required>
                            </div>
                            <div class="form-group">
                                <label for="event-time">Time:</label>
                                <input type="time" id="event-time" required>
                            </div>
                            <div class="form-group">
                                <label for="event-location">Location:</label>
                                <input type="text" id="event-location" required>
                            </div>
                            <div class="form-group">
                                <label for="event-description">Description:</label>
                                <textarea id="event-description" rows="4" required></textarea>
                            </div>
                            <div class="form-actions">
                                <button type="submit" class="btn">Save Event</button>
                                <button type="button" id="cancel-event" class="btn btn-secondary">Cancel</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <section class="cta">
        <div class="container">
            <h2>Want to Propose an Event?</h2>
            <p>Have an idea for a fundraiser or community service project? We'd love to hear from you!</p>
            <a href="contact.html" class="btn">Submit Your Idea</a>
        </div>
    </section>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <h3>Code For All</h3>
                    <p>Making coding accessible for everyone</p>
                </div>
                <div class="footer-links">
                    <h4>Quick Links</h4>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="events.html">Events</a></li>
                        <li><a href="team.html">Our Team</a></li>
                        <li><a href="contact.html">Get Involved</a></li>
                    </ul>
                </div>
                <div class="footer-contact">
                    <h4>Contact Us</h4>
                    <p><i class="fas fa-envelope"></i> zhu47578@sas.edu.sg</p>
                    <p><i class="fas fa-phone"></i> +65 8647 2776</p>
                    <p><i class="fas fa-map-marker-alt"></i> 40 Woodlands Street 41, Singapore 738547</p>
                    <div class="social-icons">
                        <a href="https://www.instagram.com" target="_blank"><i class="fab fa-instagram"></i></a>
                        <a href="https://www.twitter.com" target="_blank"><i class="fab fa-twitter"></i></a>
                        <a href="https://www.facebook.com" target="_blank"><i class="fab fa-facebook"></i></a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Code For All. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
    <script>
        // Global variables
        let currentDate = new Date();
        let events = JSON.parse(localStorage.getItem('calendarEvents')) || [];
        let currentUser = null;
        let isAdmin = false;
        let editingEventId = null;
        
        // Initialize user from existing authentication system
        function initializeUserFromAuth() {
            const savedUser = localStorage.getItem('codeforall_currentuser');
            if (savedUser) {
                try {
                    currentUser = JSON.parse(savedUser);
                    isAdmin = currentUser && currentUser.role === 'admin';
                    updateAdminUI();
                } catch (e) {
                    console.error('Error parsing saved user:', e);
                    currentUser = null;
                    isAdmin = false;
                }
            }
        }
        
        // Event tabs functionality
        const upcomingTab = document.querySelector('.upcoming-tab');
        const pastTab = document.querySelector('.past-tab');
        const upcomingEvents = document.querySelector('.upcoming-events');
        const pastEvents = document.querySelector('.past-events');
        
        upcomingTab.addEventListener('click', function() {
            upcomingTab.classList.add('active');
            pastTab.classList.remove('active');
            upcomingEvents.classList.add('active');
            pastEvents.classList.remove('active');
        });
        
        pastTab.addEventListener('click', function() {
            pastTab.classList.add('active');
            upcomingTab.classList.remove('active');
            pastEvents.classList.add('active');
            upcomingEvents.classList.remove('active');
        });
        
        // Calendar functionality
        function generateCalendar(year, month) {
            const calendarGrid = document.getElementById('calendar-grid');
            const calendarTitle = document.getElementById('calendar-title');
            
            // Clear existing calendar days (keep headers)
            const dayHeaders = calendarGrid.querySelectorAll('.calendar-day-header');
            calendarGrid.innerHTML = '';
            dayHeaders.forEach(header => calendarGrid.appendChild(header));
            
            // Set calendar title
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June',
                'July', 'August', 'September', 'October', 'November', 'December'];
            calendarTitle.textContent = `${monthNames[month]} ${year}`;
            
            // Get first day of month and number of days
            const firstDay = new Date(year, month, 1).getDay();
            const daysInMonth = new Date(year, month + 1, 0).getDate();
            const daysInPrevMonth = new Date(year, month, 0).getDate();
            
            // Add previous month's trailing days
            for (let i = firstDay - 1; i >= 0; i--) {
                const dayElement = createDayElement(daysInPrevMonth - i, true, year, month - 1);
                calendarGrid.appendChild(dayElement);
            }
            
            // Add current month's days
            for (let day = 1; day <= daysInMonth; day++) {
                const dayElement = createDayElement(day, false, year, month);
                calendarGrid.appendChild(dayElement);
            }
            
            // Add next month's leading days
            const totalCells = calendarGrid.children.length - 7; // Subtract headers
            const remainingCells = 42 - totalCells; // 6 weeks * 7 days
            for (let day = 1; day <= remainingCells; day++) {
                const dayElement = createDayElement(day, true, year, month + 1);
                calendarGrid.appendChild(dayElement);
            }
        }
        
        function createDayElement(day, isOtherMonth, year, month) {
            const dayElement = document.createElement('div');
            dayElement.className = 'calendar-day';
            if (isOtherMonth) dayElement.classList.add('other-month');
            
            const dayNumber = document.createElement('div');
            dayNumber.className = 'calendar-day-number';
            dayNumber.textContent = day;
            dayElement.appendChild(dayNumber);
            
            // Check if this day has events
            const dateStr = `${year}-${String(month + 1).padStart(2, '0')}-${String(day).padStart(2, '0')}`;
            const dayEvents = events.filter(event => event.date === dateStr);
            
            if (dayEvents.length > 0) {
                dayElement.classList.add('has-event');
                const indicator = document.createElement('div');
                indicator.className = 'event-indicator';
                dayElement.appendChild(indicator);
            }
            
            // Check if this is today
            const today = new Date();
            if (year === today.getFullYear() && month === today.getMonth() && day === today.getDate() && !isOtherMonth) {
                dayElement.classList.add('today');
            }
            
            // Add click event
            dayElement.addEventListener('click', function() {
                if (dayEvents.length > 0) {
                    showEventDetails(dayEvents);
                } else if (isAdmin && !isOtherMonth) {
                    openEventModal(dateStr);
                }
            });
            
            return dayElement;
        }
        
        function showEventDetails(dayEvents) {
            let details = 'Events on this day:\n\n';
            dayEvents.forEach(event => {
                details += `${event.title}\nTime: ${event.time}\nLocation: ${event.location}\n\n`;
            });
            alert(details);
        }
        
        // Navigation functionality will be handled in DOMContentLoaded
        
        // Authentication functions - integrated with existing system
         function checkAdminPrivileges(user) {
             return user && user.role === 'admin';
         }
         
         function initializeSession() {
             // Use existing authentication system
             initializeUserFromAuth();
         }
         
         function createSession(user) {
             // Session is already managed by the existing auth system
             // Just update local variables
             currentUser = user;
             isAdmin = checkAdminPrivileges(user);
             updateAdminUI();
         }
         
         function destroySession() {
             // Use existing auth system logout
             if (typeof authSystem !== 'undefined' && authSystem.logout) {
                 authSystem.logout();
             } else {
                 // Fallback if authSystem not available
                 localStorage.removeItem('codeforall_currentuser');
             }
             currentUser = null;
             isAdmin = false;
             updateAdminUI();
             generateCalendar(currentDate.getFullYear(), currentDate.getMonth());
         }
         
         function updateAdminUI() {
             const adminPanel = document.getElementById('admin-panel');
             const adminUserDisplay = document.getElementById('admin-user-display');
             const adminLoginBtn = document.getElementById('admin-login-btn');
             
             if (isAdmin && currentUser) {
                 adminPanel.style.display = 'block';
                 adminUserDisplay.textContent = `(${currentUser.username || currentUser.name || 'Admin'})`;
                 if (adminLoginBtn) adminLoginBtn.style.display = 'none';
             } else {
                 adminPanel.style.display = 'none';
                 adminUserDisplay.textContent = '';
                 addAdminLoginButton();
             }
         }
         
         // Add admin login button to admin panel
         function addAdminLoginButton() {
             const adminPanel = document.querySelector('.admin-panel');
             let loginBtn = document.getElementById('admin-login-btn');
             
             if (!isAdmin && !loginBtn) {
                 loginBtn = document.createElement('button');
                 loginBtn.id = 'admin-login-btn';
                 loginBtn.className = 'btn btn-primary';
                 loginBtn.textContent = 'Admin Login';
                 loginBtn.onclick = function() {
                     // Redirect to login page instead of opening modal
                     window.location.href = 'login.html';
                 };
                 adminPanel.appendChild(loginBtn);
                 adminPanel.style.display = 'block';
             } else if (loginBtn) {
                 loginBtn.style.display = isAdmin ? 'none' : 'block';
             }
         }
        
        // Modal functionality
         
         function openEventModal(date = '') {
             // Check admin authorization before opening
             if (!isAdmin) {
                 alert('Access denied. Admin privileges required.');
                 return;
             }
             
             const modal = document.getElementById('event-modal');
             const form = document.getElementById('event-form');
             form.reset();
             
             if (date) {
                 document.getElementById('event-date').value = date;
             }
             
             document.getElementById('modal-title').textContent = editingEventId ? 'Edit Event' : 'Add New Event';
             modal.style.display = 'block';
         }
         
         function closeEventModal() {
             document.getElementById('event-modal').style.display = 'none';
             editingEventId = null;
         }
        

         
         // Event form submission
         document.getElementById('event-form').addEventListener('submit', function(e) {
             e.preventDefault();
             
             // Double-check admin authorization
             if (!isAdmin) {
                 alert('Access denied. Admin privileges required.');
                 closeEventModal();
                 return;
             }
             
             const eventData = {
                 id: editingEventId || Date.now().toString(),
                 title: document.getElementById('event-title').value,
                 date: document.getElementById('event-date').value,
                 time: document.getElementById('event-time').value,
                 location: document.getElementById('event-location').value,
                 description: document.getElementById('event-description').value,
                 createdBy: currentUser.username,
                 createdAt: new Date().toISOString()
             };
             
             if (editingEventId) {
                 const index = events.findIndex(event => event.id === editingEventId);
                 if (index !== -1) {
                     eventData.modifiedBy = currentUser.username;
                     eventData.modifiedAt = new Date().toISOString();
                     events[index] = eventData;
                 }
             } else {
                 events.push(eventData);
             }
             
             localStorage.setItem('calendarEvents', JSON.stringify(events));
             generateCalendar(currentDate.getFullYear(), currentDate.getMonth());
             closeEventModal();
         });
        
        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Load events from localStorage
            const savedEvents = localStorage.getItem('calendarEvents');
            if (savedEvents) {
                events = JSON.parse(savedEvents);
            }
            
            // Initialize session and calendar
            initializeSession();
            generateCalendar(currentDate.getFullYear(), currentDate.getMonth());
            
            // Add admin functionality
            addAdminLoginButton();
            
            // Navigation buttons
            document.getElementById('prev-month').addEventListener('click', function() {
                currentDate.setMonth(currentDate.getMonth() - 1);
                generateCalendar(currentDate.getFullYear(), currentDate.getMonth());
            });
            
            document.getElementById('next-month').addEventListener('click', function() {
                currentDate.setMonth(currentDate.getMonth() + 1);
                generateCalendar(currentDate.getFullYear(), currentDate.getMonth());
            });
            
            // Modal close buttons
             document.getElementById('close-modal').addEventListener('click', closeEventModal);
             document.getElementById('cancel-event').addEventListener('click', closeEventModal);
             
             // Close modals when clicking outside
             window.addEventListener('click', function(event) {
                 const eventModal = document.getElementById('event-modal');
                 
                 if (event.target === eventModal) {
                     closeEventModal();
                 }
             });
             
             // Admin panel button event listeners
             const addEventBtn = document.getElementById('add-event');
             const hideAdminPanelBtn = document.getElementById('hide-admin-panel');
             const logoutBtn = document.getElementById('logout-btn');
             
             if (addEventBtn) {
                 addEventBtn.addEventListener('click', function() {
                     if (isAdmin) {
                         openEventModal();
                     }
                 });
             }
             
             if (hideAdminPanelBtn) {
                 hideAdminPanelBtn.addEventListener('click', function() {
                     const adminPanel = document.getElementById('admin-panel');
                     if (adminPanel) {
                         adminPanel.style.display = 'none';
                     }
                 });
             }
             
             if (logoutBtn) {
                 logoutBtn.addEventListener('click', function() {
                     destroySession();
                 });
             }
        });
    </script>
</body>
</html>